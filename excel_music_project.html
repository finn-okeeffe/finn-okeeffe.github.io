<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Finn's Portfolio Site</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="index.html">Finn's Projects Portfolio</a></h1>
						<nav>
							<a href="#menu">Menu</a>
						</nav>
					</header>

				<!-- Menu -->
					<nav id="menu">
						<div class="inner">
							<h2>Menu</h2>
							<ul class="links">
								<li><a href="index.html">Home</a></li>
								<li><a href="all_projects.html">All Projects</a></li>
							</ul>
							<a href="#" class="close">Close</a>
						</div>
					</nav>

				<!-- Wrapper -->
					<section id="wrapper">
						<header>
							<div class="inner">
								<h2>Excel: Aggregating and Cleaning Chord data from Rock Songs</h2>
								<p>Phasellus non pulvinar erat. Fusce tincidunt nisl eget ipsum.</p>
							</div>
						</header>

						<!-- Content -->
							<div class="wrapper">
								<div class="inner">

									<h3 class="major">Data Source</h3>
									<p>
										This project uses data from <a href="http://rockcorpus.midside.com/index.html"><i>A Corpus Study of Rock Music</i>, by Trevor de Clerq and David Temperley</a>.
										This project analysed the top 200 songs from the <a href="https://www.rollingstone.com/">Rolling Stone magazine's</a> list of the <a href="http://web.archive.org/web/20080622145429/www.rollingstone.com/news/coverstory/500songs">"500 Greatest Songs of All Time"</a>, providing a transcription of the melody and a harmonic analysis.
									</p>

									<h3 class="major">RS200.csv</h3>
									<p>
										Trevor and David have provided a csv file, <code>RS200.csv</code>, with data about the releases.
										This part of the data is very easy to clean, after importing with Power Query, all we need to do is set the column titles.
										I have removed the last column in the file, which stated if the song was present in a previous dataset. This isn't needed for our analysis.
										The before and after of this file can be seen below.
									</p>
									<p><span class="image"><img src="images\music project PowerQuery rs200 csv.jpg"/></span></p>

									<h3 class="major">Chord Data</h3>
									<p>
										Trevor and David have provided the chord data a file for each song.
										There are two versions of each file, one ending in _dt, one ending in _tdc.
										This is because both Trevor and David did the harmonic analysis for each song. Since chord sequences can be subjective, there may be differences between their analysis.
									</p>
									<p><span class="image"><img src="images\chord_data_folder.png"/></span></p>
									<p>
										To perform analysis, we will need to import this data into Excel and combine it into one table.
										We do this by importing from a folder as follows:
									</p>
									<p><span class="image"><img src="images\powerquery_importing_from_folder.png"/></span></p>
									<p>
										This automates most of the hard work to import and merge all these files. And after a little renaming of columns we get the following,
									</p>
									<p><span class="image"><img src="images\powerquery_imported_and_merged_chord_data.png"/></span></p>
									
									<h4 class="minor">Splitting the Filename into its components</h4>
									<p>
										There's one last thing to do before we can import this into the work sheet.
										The filename field effectively contains two fields worth of data: the song id as appears in RS200.csv, and the person who did the analysis.
									</p>
									<p>
										Before parsing the filename text, I duplicated the column. This way I could be sure to keep the original filename data.
										Then, I split the column by the last "_" delimiter to separate the song id from the author initials. Finally, I removed the .clt extension by extracting the text before the delimiter.
										These operations can be found in PowerQuery in the transform tab, as seen below.
									</p>
									
									<div class="box alt">
										<div class="row gtr-uniform">
											<div class="col-6"><span class="image fit"><img src="images\split_column_by_delimiter.png" alt="" /></span></div>
											<div class="col-6"><span class="image fit"><img src="images\split_filename_into_key_and_author.png" alt="" /></span></div>
											<div class="col-6"><span class="image fit"><img src="images\extract_text_before_delimiter.png" alt="" /></span></div>
											<div class="col-6"><span class="image fit"><img src="images\remove_file_format.png" alt="" /></span></div>
											<div class="col-12"><span class="image fit"><img src="images\separated_filename.png" alt="" /></span></div>
										</div>
									</div>
									<p>
										In general, you need to be careful when parsing text like this. If the delimiters aren't exactly where you expect them, then the text won't split like you expect.
										In this case the filenames are structured enough that we can be sure of exactly how it will split.
									</p>
									<p>There we go, we've successfully imported, aggregated, and cleaned our data. The final table of chord data has 36,970 rows. PowerQuery made that much easier than it had any right to be. Next we will validate the data, and finally we will perform some simple analysis.</p>

									<h3 class="major">Data Validation</h3>
									<p>Lorm Ipsum</p>

									<h3 class="major">Basic Analysis and Visualisation</h3>
									<p>Lorm Ipsum</p>
								</div>
							</div>

					</section>

				<!-- Footer -->
				<section id="footer">
					<div class="inner">
						<ul class="contact">
							<li class="icon solid fa-home">
								Christchurch, New Zealand
							</li>
							<li class="icon solid fa-envelope"><a href="mailto:okeeffefinn@gmail.com">okeeffefinn@gmail.com</a></li>
							<li class="icon brands fa-linkedin"><a href="https://www.linkedin.com/in/finn-okeeffe/">linkedin.com/in/finn-okeeffe/</a></li>
							<li class="icon brands fa-github"><a href="https://github.com/finn-okeeffe">finn-okeeffe</a></li>
						</ul>
						<ul class="copyright">
							<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
							<li><a href="https://github.com/finn-okeeffe/finn-okeeffe.github.io">Website GitHub Repo</a></li>
						</ul>
					</div>
				</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>